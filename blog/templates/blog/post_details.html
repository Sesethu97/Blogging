{% extends 'base.html' %}
{% load humanize %}

{% load static %}
{% block title %}posts_details{% endblock %}

{% block content %}

<style>
    .card-img{
    border-radius: 50%;
}
</style>

<h1>{{ post.title }} </h1>

<small>By: {{ post.author.first_name}} {{ post.author.last_name}}  - {{ post.post_date}}
    {% if user.is_authenticated %}
    {% if user.id == post.author.id %}

    -<a href="{% url 'blog:update_post' pk=post.pk %}">Edit</a>
    <a href="{% url 'blog:delete_post' pk=post.pk %}">Delete</a>

    {% endif %}
    {% endif %}

</small><br />
<hr>
<br />

{% if post.header_image %}
<img src="{{ post.header_image.url }}" />
{% endif %}
<div class="w-screen">
<p class="break-normal">{{ post.body|safe }}</p>
</div>
<br /><br />
<a href="{% url 'blog:home' %}" class="btn btn-secondary">Back</a>
<br /><br />

<a class="btn btn-primary btn-sm" href="{% url 'blog:cast_vote' pk=post.pk vote_value=1 %}">LIke</a>
<a class="btn btn-danger btn-sm" href="{% url 'blog:cast_vote' pk=post.pk vote_value=-1 %}">dislike</a>

<hr>
<br />
{% comment %}<form action="{% url 'blog:like_post' pk=post.pk %}" method="POST">
    {% csrf_token %}
    {% if user.is_authenticated %}

    {% if liked%}
    <button type="submit" , class="btn btn-danger btn-sm" , name="post_id" , value="{{ post.id }}"> UnLike</button>
    {% else %}
    <button type="submit" , class="btn btn-primary btn-sm" , name="post_id" , value="{{ post.id }}"> Like</button>
    {% endif %}
    {% else %}
    <small><a href="{% url 'users:login' %}">Login to Like</small></a>
    {% endif %}

    - {{ total_likes}} like
</form>


<hr>
<br />
<form action="{% url 'blog:dislike_post' pk=post.pk %}" method="POST">
    {% csrf_token %}
    {% if user.is_authenticated %}

    {% if disliked %}

    <button type="submit" , class="btn btn-danger btn-sm" , name="post_id" , value="{{ post.id }}"> unDislike</button>
    {% else %}
    <button type="submit" , class="btn btn-primary btn-sm" , name="post_id" , value="{{ post.id }}"> Dislike</button>

    {% endif %}
    {% else %}
    <small><a href="{% url 'users:login' %}">Login to Dislike</small></a>
    {% endif %}

    - {{ total_dislikes}} Dislike
</form>
<br /><br />{% endcomment %}

<div class="card-mb-3">
    <div class="row no-gutters">
        <div class="col-md-2">
            {% if post.author.profile_picture %}
            <img src="{{ post.author.profile_picture.url }}" class="card-img"  />

            {% else %}
            <img src="{% static 'startblog/images/download.png' %}" class="card-img"  />

            {% endif %}
        </div>
        <div class="col-md-10">
            <div class="card-body">
                <h5 class="card-title"> 
                    <a href="{% url 'users:show_profile' post.author.id %}">{{ post.author.first_name}} {{ post.author.last_name}}</a></h5>
                <p class="small text-muted">
                    {% if post.author.website_url%}
                        <a href="post.author.website_url">Website | </a>
                    
                    {% endif %}
                    {% if post.author.facebook_url%}

                    <a target="_blank" href="{{post.author.facebook_url}}">Facebook | </a>
                    {% endif %}
                    {% if post.author.twitter_url%}

                    <a target="_blank" href="{{post.author.twitter_url}}">Twitter | </a>
                    {% endif %}
                    {% if post.author.instagram_url%}

                    <a target="_blank" href="{{post.author.instagram_url}}">Instagram | </a>
                    {% endif %}
                    {% if post.author.pinterest_url%}

                    <a target="_blank" href="{{post.author.pinterest_url}}">Pinterest </a>
                    {% endif %}
                
                <p class="card-text text-muted">{{ post.author.bio}}</p>
                <p class="card-text"><small class="text-muted">last updateed: {{post.post_time|naturaltime}}</small></p>


            </div>


        </div>

    </div>
</div>



{% endblock %}